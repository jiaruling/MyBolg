---
title: "数据类型"
date: 2024-05-07T14:53:05+08:00
lastmod: 2024-05-07T14:53:05+08:00
author: ["me"]
categories: ["web3"] # 没有分类界面可以不填写
tags: [""] # 标签
description: ""
weight:
slug: ""
draft: false # 是否为草稿
comments: true # 本页面是否显示评论
reward: true # 打赏
mermaid: true #是否开启mermaid
showToc: true # 显示目录
TocOpen: true # 自动展开目录
hidemeta: false # 是否隐藏文章的元信息，如发布日期、作者等
disableShare: true # 底部不显示分享栏
showbreadcrumbs: true #顶部显示路径
#   cover:
#     image: "" #图片路径例如：posts/tech/123/123.png
#     zoom: # 图片大小，例如填写 50% 表示原图像的一半大小
#     caption: "" #图片底部描述
#     alt: ""
#     relative: false
---

## 值类型

- 基本数据类型: 整数，枚举，布尔
- Address，contract
- Fixed byte array(定长字节数组)

### 整型

- int/uint以8位字节递增，uint是uint256的别名
- 对于整型数类型x，可以用`type(x).min`和`type(x).max`取这个类型的最小或最大值
- 以太坊虚拟机是256位的机器
- 低版本取模，高版本：异常；Safe'Math

### 枚举

- 枚举是用户创建自定义类型的一种方法(contract, struct, enum)
- 可以与整型数显式转换(隐式不行)
- 整型到枚举的转换会检查是否越界
- 枚举最少一个成员，最多256成员(uint8)，默认值第一个成员
- 从0开始的无符号整型数(与c相同)

```solidity
// SPDX-License-Identifier: GPL-3.0

pragma solidity >=0.8.2 <0.9.0;

contract BasicType{
    function testInt8() public pure returns (uint8) {
        uint8  i8 = 255;
        // i8++; // 运行时数据越界报错
        uint16 i16 = 258;
        // i16 = i8; // uint8给uint16赋值可以
        i8 = uint8(i16); // uint16给uint8赋值必须强制转换 数据超过255会发送丢失，256 -> 0; 257 -> 1; 258 -> 2
        return i8;
    }

    function testInt() public pure returns (uint) {
        uint max = type(uint).max;
        return max;
    }

    // 枚举数据类型
    enum OrderState{layorder, payment}
    function testEnum(uint8 post) public  pure returns (OrderState) {
        OrderState state;
        if (post < 10) {
            state = OrderState.layorder;
        } else {
            state = OrderState.payment;
        }
        return state; // 最终输出的数据类型是uint8
    } 
}
```

### Address

- addres: 20个字节长度
- 关于可支付
  - address payable: 可支付，有成员函数transfer和send
  - address payable可转换为address，反之需要显示转换
- address可转换为uint160和bytes20
- 合约账号地址与外部账号地址 EOA External Owned Account
- call，balance等，很大程度上address并不只是一个数据类型

### Contract

- 合约可以隐式转换为它的父合约(多态)
- 合约可以显示转换为地址类型address
- 合约不支持任何运算符
- 从合约变量(实例)调用合约函数(根本性质)
- 合约可用new操作符部署另一合约

### Fixed byte array

- 从bytes1到bytes32（bytes1是8位，bytes32是256位）
- 通过下标访问元素，只能读取不能访问
- 通过length读取长度

```solidity
// SPDX-License-Identifier: GPL-3.0

pragma solidity >=0.8.2 <0.9.0;

contract ComplexValueType{

    // address type
    function testAddress() public view returns(address) {
        address addr = msg.sender; // 获取合约调用者的地址
        return addr;
    }

    function testMyAddress() public view returns(address) {
        address addr = address(this); // 获取本合约的地址
        return addr;
    }

    // contract type
    function testContract() public view returns(ComplexValueType) {
        ComplexValueType myContract = this;
        return myContract;
    }

    // Fixed byte array
     function testFixedByteArray1() public pure returns(bytes3) {
        bytes3 data = 0xf11110; // 默认初始值 0x000000
        return data;            // 0xf11110
    }

    function testFixedByteArray2() public pure returns(bytes1) {
        bytes3 data = 0xf11110;
        bytes1 first = data[0];
        return first;  // 0xf1
    }
}
```

## 引用类型

### 数组

### 结构体

### 映射



